// Truth Serum - Weekly Solar Wisdom
// Authentic teachings from the fusion of revolutionary consciousness and solar science

export interface TruthSerumEntry {
  id: string;
  category: string;
  title: string;
  teaching: string;
  week?: number;
}

export const truthSerumTeachings: TruthSerumEntry[] = [
  // Beginner's Path
  {
    id: "beginner-1",
    category: "Beginning Practice",
    title: "The First Solar Communion",
    teaching: "My beloved, the sun is not your enemy to be conquered, but your oldest friend to be embraced with reverence. Begin like a lover meeting the beloved - with patience, with gentleness. Look at the sun only during the golden hours, when it rises or sets, when its rays are soft like a mother's caress. Start with ten seconds, no more.",
    week: 1
  },
  {
    id: "beginner-2", 
    category: "Beginning Practice",
    title: "The Democracy of Light",
    teaching: "The sun shines on all - the rich and poor, the believer and atheist, the healthy and sick. But not everyone is ready to receive its gift. Begin with seconds, add ten seconds each day if your eyes feel comfortable. Some reach ten minutes after months, others after years. The journey itself is the destination.",
    week: 2
  },
  {
    id: "beginner-3",
    category: "Beginning Practice", 
    title: "Drop the Mind's Questions",
    teaching: "Drop the idea of 'how' - the sun has been calling you since your first breath. Face the gentle morning sun for 10 seconds and feel your ancestors' wisdom awakening.",
    week: 3
  },

  // Fear and Safety
  {
    id: "safety-1",
    category: "Transcending Fear",
    title: "Fear is the Greatest Blindness", 
    teaching: "Fear is the greatest blindness, not the sun's light. But listen carefully - I am not asking you to be foolish. The path of the mystic is always intelligent. Trust your body's wisdom. If there is pain, stop. The sun has waited millions of years for you; it can wait a few more days.",
    week: 4
  },
  {
    id: "safety-2",
    category: "Transcending Fear",
    title: "The Medical Church's Greatest Gift",
    teaching: "They sold you fear of your star. This is the ultimate rebellion - remembering your light body. Advanced practitioners have lived on sunlight for extended periods under medical observation and thrived. Your fear is institutional programming, not the sun's truth.",
    week: 5
  },
  {
    id: "safety-3",
    category: "Transcending Fear", 
    title: "Your Ancient Friend",
    teaching: "Safety? The sun has been humanity's closest companion for millions of years - suddenly you need permission to look at your ancient friend? Practice during golden hours and trust your cosmic inheritance.",
    week: 6
  },

  // Time and Rhythm
  {
    id: "time-1",
    category: "Sacred Timing",
    title: "Illusion of Time, Eternal Truth",
    teaching: "Time, my friend, is an illusion, but the sun's rhythm is eternal truth. Within the first hour of sunrise and the last hour of sunset - these are the windows when heaven touches earth. Begin with ten seconds, no more. The ego wants to rush, but the soul knows that all great transformations happen slowly, like the blooming of a lotus.",
    week: 7
  },
  {
    id: "time-2",
    category: "Sacred Timing",
    title: "The Sun's Perfect Timing",
    teaching: "The sun has no watch, yet it never misses its appointment with dawn. Start with 10 seconds - your cellular wisdom knows when enough light has been absorbed.",
    week: 8
  },
  {
    id: "time-3",
    category: "Sacred Timing",
    title: "Sacred Courtship with Consciousness",
    teaching: "Master practitioners built up to hours over months, not minutes over days. Your journey is not a race but a sacred courtship with cosmic consciousness.",
    week: 9
  },

  // Physical Transformation
  {
    id: "physical-1",
    category: "Body's Awakening",
    title: "Tears of Preparation", 
    teaching: "Tears are the eyes' way of cleansing and adjusting. Like a river washing stones smooth, your tears are preparing the windows of perception. In the beginning, this is natural. But if the tearing is excessive or painful, reduce your practice time. The body has its own intelligence - honor it.",
    week: 10
  },
  {
    id: "physical-2",
    category: "Body's Awakening",
    title: "Third Eye Activation",
    teaching: "Your third eye is awakening through solar activation - the pressure is cosmic consciousness expanding. Start with shorter sessions and let your pineal gland adjust to its divine remembering.",
    week: 11
  },
  {
    id: "physical-3",
    category: "Body's Awakening",
    title: "Solar Collectors Awakening", 
    teaching: "Your eyes are remembering they are solar collectors, not just windows. Practice only during the golden hour when the sun is gentle - force is the mind's way, not the sun's.",
    week: 12
  },

  // Energy Transformation
  {
    id: "energy-1",
    category: "Solar Energy",
    title: "The Original Power Source",
    teaching: "You are plugging into the original power source! Most people live on secondhand energy - food, coffee, external stimulation. But you are learning to drink directly from the fountain of cosmic energy. This is why advanced practitioners can transcend the need for gross food. You are remembering how to be solar-powered, like the plants that stretch toward the light.",
    week: 13
  },
  {
    id: "energy-2",
    category: "Solar Energy",
    title: "Light Body Being Born",
    teaching: "Your pineal gland is expanding as documented in advanced practitioners - the tiredness is your light body being born. Rest deeply, for you are transforming from matter-eater to light-eater.",
    week: 14
  },
  {
    id: "energy-3",
    category: "Solar Energy", 
    title: "Cosmic Fuel Rewiring",
    teaching: "Solar energy is rewiring your cellular batteries - of course you are tired! Your body is learning to run on cosmic fuel instead of coffee and calories.",
    week: 15
  },

  // Benefits and Results
  {
    id: "results-1",
    category: "Beyond Benefits",
    title: "Source of All Life",
    teaching: "The sun is the source of all life on earth - how can communing with it not bring health? Regular practice has been shown to improve bone density through vitamin D synthesis, regulate sleep cycles, boost immune function, and increase overall vitality. But the greatest healing happens beyond the physical - in the integration of solar consciousness into your being.",
    week: 16
  },
  {
    id: "results-2",
    category: "Beyond Benefits", 
    title: "Not a Spiritual Supermarket",
    teaching: "Benefits? You are not shopping at a spiritual supermarket! You are remembering your cosmic heritage. The documented enlarged pineal glands of master practitioners were not benefits - they were homecomings.",
    week: 17
  },
  {
    id: "results-3",
    category: "Beyond Benefits",
    title: "Transformation Beyond Dreams",
    teaching: "What will happen is beyond your wildest dreams and smaller than your smallest hope. The sun transforms you into itself - there is no 'you' left to receive benefits.",
    week: 18
  },

  // Spiritual Awakening
  {
    id: "spiritual-1", 
    category: "Consciousness Awakening",
    title: "Bliss of Recognition",
    teaching: "When the drop merges with the ocean, is the bliss real or imaginary? Your joy is the recognition of your true nature. The sun's light is awakening the light within you - of course there is bliss! But don't become attached even to this beautiful experience. Let it come, let it go, like waves on the shore of consciousness.",
    week: 19
  },
  {
    id: "spiritual-2",
    category: "Consciousness Awakening",
    title: "Mirror of Solar Intelligence",
    teaching: "The ultimate goal is not to stare at the sun for hours or to live without food - these may or may not happen naturally. The real goal is the recognition of your own essential nature as light, as consciousness itself. The external sun serves as a mirror, reflecting back to you the solar intelligence that you already are.",
    week: 20
  },
  {
    id: "spiritual-3",
    category: "Consciousness Awakening", 
    title: "The Ultimate Cosmic Joke",
    teaching: "You are asking the sun about the sun while standing in sunlight. This is the ultimate cosmic joke - you ARE what you seek to understand.",
    week: 21
  },

  // Diet and Transformation
  {
    id: "diet-1",
    category: "Light Nutrition",
    title: "Remembering Original Nature", 
    teaching: "The body that learns to live on light alone has remembered its original nature. Advanced practitioners have demonstrated this possibility - that we can transcend the gross dependency on material food. But beware of making this the goal. The goal is consciousness, not just physical phenomena. Many have harmed themselves rushing toward this attainment. Let it happen naturally if it is meant to happen.",
    week: 22
  },
  {
    id: "diet-2",
    category: "Light Nutrition",
    title: "Cosmic Cuisine",
    teaching: "Master practitioners have proven for extended periods that consciousness can feast on light itself. Your stomach is confused because your cells are learning a new menu - cosmic cuisine.",
    week: 23
  },
  {
    id: "diet-3",
    category: "Light Nutrition",
    title: "Biological Solar Cells",
    teaching: "Just as plants photosynthesize sunlight into food, human beings can learn to absorb and metabolize light directly. This is not fantasy but physics - we are biological solar cells that have forgotten how to operate efficiently.",
    week: 24
  },

  // Solar Method and Legacy
  {
    id: "method-1",
    category: "Solar Method Legacy",
    title: "Ancient Practice, Modern Translation",
    teaching: "Modern solar practitioners brought ancient wisdom to contemporary seekers, like translating Sanskrit poetry into today's language. The systematic approach - nine months, specific increments, eventual freedom from food dependency - appeals to the Western mind that loves structure. But remember, this is one melody in the vast symphony of solar practices. Take what resonates, leave what doesn't serve your unique journey.",
    week: 25
  },
  {
    id: "method-2", 
    category: "Solar Method Legacy",
    title: "Nine Months of Rebirth",
    teaching: "Nine months - the same time for a human birth! There is wisdom in this timing. First three months: building tolerance, healing eyes, beginning detoxification. Second three months: deeper changes in hunger patterns, energy levels, mental clarity. Final three months: profound transformations that cannot be spoken of, only experienced. But do not be bound by this timeframe - some need longer, others progress faster.",
    week: 26
  },
  {
    id: "method-3",
    category: "Solar Method Legacy", 
    title: "Extended Practice Proof",
    teaching: "Master practitioners have sustained extended solar practice under continuous medical observation and thrived beyond all expectations. Your fear is institutional programming designed to keep you dependent on their systems.",
    week: 27
  },

  // Challenges and Obstacles
  {
    id: "challenges-1",
    category: "Overcoming Obstacles",
    title: "The Ego's Resistance",
    teaching: "Forgetting is the mind's resistance to transformation. The ego knows that consistent sun practice will dissolve its dominance, so it creates forgetfulness, excuses, obstacles. Set a gentle routine, like meeting a beloved friend at the same time each day. Let the practice be a joy, not a burden. When you forget, simply begin again without self-judgment.",
    week: 28
  },
  {
    id: "challenges-2",
    category: "Overcoming Obstacles", 
    title: "Silent Underground Growth",
    teaching: "The most profound transformations happen silently, invisibly, like seeds growing underground. You may not feel anything dramatic, but changes are happening at cellular, energetic, and consciousness levels. The Western mind expects immediate, obvious results. But the ancient practices work slowly, deeply, permanently. Trust the process even when the ego demands entertainment.",
    week: 29
  },
  {
    id: "challenges-3",
    category: "Overcoming Obstacles",
    title: "Never Rape Your Being", 
    teaching: "Never rape your own being with forced spiritual practice! Some days the body needs rest, the eyes need a break, the soul wants to commune with the sun through other means. Listen to your inner wisdom. But also examine - is this genuine need or just mental resistance?",
    week: 30
  },

  // Advanced Practice
  {
    id: "advanced-1",
    category: "Advanced Solar Mastery",
    title: "Becoming Solar Yourself",
    teaching: "The advanced student learns that sungazing is not about staring for hours but about becoming solar yourself. After months of practice, your relationship with light transforms - you begin to emit rather than just absorb.",
    week: 31
  },
  {
    id: "advanced-2",
    category: "Advanced Solar Mastery",
    title: "Quality Over Quantity", 
    teaching: "True advancement is measured not in minutes but in the quality of your inner light. Some 'beginners' radiate more solar consciousness than those who have practiced for years with ego as their guide.",
    week: 32
  },
  {
    id: "advanced-3",
    category: "Advanced Solar Mastery",
    title: "Inner Sungazing",
    teaching: "The deepest practice happens when you close your eyes and feel the sun's presence within your heart. This inner sungazing transforms you from light-seeker to light-bearer.",
    week: 33
  },

  // Environmental Wisdom
  {
    id: "environment-1",
    category: "Natural Rhythms", 
    title: "The Sun's Love Letters",
    teaching: "Clouds are the sun's love letters - they carry solar energy to every corner of the earth. Even on cloudy days, 80% of the sun's life force penetrates. Your practice continues, for the sun is always present behind the veil.",
    week: 34
  },
  {
    id: "environment-2",
    category: "Natural Rhythms",
    title: "Winter's Deep Teaching",
    teaching: "Winter sun is the deepest teacher - when the light is scarce, your hunger for it becomes pure. These are the months when your solar sensitivity develops most profoundly.",
    week: 35
  },
  {
    id: "environment-3",
    category: "Natural Rhythms",
    title: "Inner Sky, Outer Weather",
    teaching: "The sun shines equally on clear and cloudy days. Your inner sky can be cloudless even when the outer sky weeps. This is the difference between weather-dependent humans and solar-conscious beings.",
    week: 36
  },

  // Age and Universal Access
  {
    id: "age-1",
    category: "Timeless Practice",
    title: "No Birth Certificates for the Sun",
    teaching: "The sun recognizes no birth certificates. A child's eyes are naturally pure solar collectors, while an elder's eyes carry the wisdom of countless sunrises. Both are perfect for receiving the sun's gift.",
    week: 37
  },
  {
    id: "age-2", 
    category: "Timeless Practice",
    title: "Soul Age vs. Calendar Age",
    teaching: "Your chronological age is irrelevant to cosmic age. Some souls are ancient at twenty, others are newborns at seventy. The sun reads your soul's readiness, not your body's calendar.",
    week: 38
  },
  {
    id: "age-3",
    category: "Timeless Practice",
    title: "Childlike Wonder Returns",
    teaching: "Children practice sungazing naturally until we teach them fear. If you have forgotten this innocence, sungazing will help you remember the child-like wonder that sees the sun as friend, not enemy.",
    week: 39
  },

  // Medical Wisdom
  {
    id: "medical-1",
    category: "Health and Healing",
    title: "Reclaiming Innate Intelligence", 
    teaching: "The Medical Church has trained you to fear your own healing. But I am not telling you to ignore genuine medical wisdom - I am asking you to reclaim your innate intelligence about light and health.",
    week: 40
  },
  {
    id: "medical-2",
    category: "Health and Healing",
    title: "Body as Doctor, Sun as Medicine",
    teaching: "Your body is the ultimate doctor, the sun is the ultimate medicine. But if you have serious eye conditions, let both modern medicine and ancient wisdom guide you. Truth needs no fanaticism.",
    week: 41
  },
  {
    id: "medical-3",
    category: "Health and Healing", 
    title: "Original Medicine",
    teaching: "Every cell in your body was designed to receive and process light. This is not alternative medicine - this is original medicine, the healing modality that predates all others.",
    week: 42
  },

  // Vision and Sight
  {
    id: "vision-1",
    category: "Seeing and Vision",
    title: "Eye Exercises Through Light",
    teaching: "Glasses are crutches for eyes that have forgotten how to exercise. Some practitioners find their vision improving through sungazing as the eye muscles strengthen and the visual cortex awakens. But remove glasses only during practice, never risk safety.",
    week: 43
  },
  {
    id: "vision-2",
    category: "Seeing and Vision",
    title: "Eyes' Original Design", 
    teaching: "Your eyes were designed to function perfectly without artificial lenses. Sungazing may gradually restore natural vision as it did for many practitioners, but this healing happens slowly, organically, naturally.",
    week: 44
  },
  {
    id: "vision-3",
    category: "Seeing and Vision",
    title: "Vision vs. Perception",
    teaching: "The question is not whether you can see the sun clearly, but whether the sun can see clearly into you. Vision is not about sharpness of sight but clarity of perception.",
    week: 45
  },

  // Cultural Heritage  
  {
    id: "culture-1",
    category: "Ancient Wisdom",
    title: "Universal Solar Practices",
    teaching: "Every indigenous culture on earth has sun practices - from the Aztec to the Aboriginal, from Egyptian to Tibetan. You are not learning something new, you are remembering something ancient.",
    week: 46
  },
  {
    id: "culture-2",
    category: "Ancient Wisdom",
    title: "Systematic Erasure", 
    teaching: "Your ancestors knew the sun as grandfather, as divine consciousness, as the source of all life. This knowledge was systematically erased by institutions that profit from your disconnection from natural healing.",
    week: 47
  },
  {
    id: "culture-3", 
    category: "Ancient Wisdom",
    title: "Returning to Solar Roots",
    teaching: "The Egyptians built temples aligned with the sun's path, the Greeks studied heliotherapy, the Indians developed surya yoga. Modern sungazing is humanity returning to its solar roots.",
    week: 48
  },

  // Scientific Integration
  {
    id: "science-1",
    category: "Science Meets Mysticism",
    title: "Science Catching Up", 
    teaching: "Science is slowly catching up to what mystics have always known. Research on light therapy, circadian rhythms, vitamin D synthesis, and pineal gland function validates ancient solar practices.",
    week: 49
  },
  {
    id: "science-2",
    category: "Science Meets Mysticism",
    title: "You Are the Research",
    teaching: "The proof is not in laboratories but in your own experience. Become your own research subject. Practice with intelligence and observe the changes with scientific precision.",
    week: 50
  },
  {
    id: "science-3",
    category: "Science Meets Mysticism",
    title: "Two Perspectives, Complete Understanding", 
    teaching: "Modern science studies the sun as nuclear fusion, ancient science knew it as consciousness itself. Both perspectives are needed for complete understanding.",
    week: 51
  },

  // Final Wisdom - Preparation and Integration
  {
    id: "final-1",
    category: "Ultimate Integration",
    title: "Simple Willingness",
    teaching: "The only preparation needed is willingness to be transformed. Clean your eyes with pure water, clean your heart with pure intention, clean your mind of all expectations.",
    week: 52
  }
];

// Utility functions for Truth Serum system
export function getCurrentWeekOfYear(): number {
  const now = new Date();
  const start = new Date(now.getFullYear(), 0, 1);
  const diff = now.getTime() - start.getTime();
  const oneWeek = 1000 * 60 * 60 * 24 * 7;
  return Math.floor(diff / oneWeek) + 1;
}

// Get the user's subscription start date to calculate their personal week progression
export function getUserWeekProgression(subscriptionStartDate: Date): number {
  const now = new Date();
  const diff = now.getTime() - subscriptionStartDate.getTime();
  const oneWeek = 1000 * 60 * 60 * 24 * 7;
  const weeksPassed = Math.floor(diff / oneWeek);
  
  // Always start at week 1, even on day 1
  return Math.max(1, weeksPassed + 1);
}

// Check if a teaching is unlocked for the user
export function isTeachingUnlocked(teaching: TruthSerumEntry, subscriptionStartDate: Date): boolean {
  if (!teaching.week) return true; // Teachings without week numbers are always available
  const userWeek = getUserWeekProgression(subscriptionStartDate);
  return teaching.week <= userWeek;
}

// Get all unlocked teachings for the user
export function getUnlockedTeachings(subscriptionStartDate: Date): TruthSerumEntry[] {
  return truthSerumTeachings.filter(teaching => isTeachingUnlocked(teaching, subscriptionStartDate));
}

// Get unlocked teachings organized by category
export function getUnlockedTeachingsByCategory(subscriptionStartDate: Date): Record<string, TruthSerumEntry[]> {
  const unlockedTeachings = getUnlockedTeachings(subscriptionStartDate);
  return unlockedTeachings.reduce((acc, teaching) => {
    if (!acc[teaching.category]) {
      acc[teaching.category] = [];
    }
    acc[teaching.category].push(teaching);
    return acc;
  }, {} as Record<string, TruthSerumEntry[]>);
}

// Get the current week's teaching for the user
export function getCurrentTruthSerum(subscriptionStartDate?: Date): TruthSerumEntry | null {
  if (!subscriptionStartDate) {
    // Fallback to calendar week for non-subscribers
    const currentWeek = getCurrentWeekOfYear();
    return getTruthSerumForWeek(currentWeek);
  }
  
  const userWeek = getUserWeekProgression(subscriptionStartDate);
  return getTruthSerumForWeek(userWeek);
}

export function getTruthSerumForWeek(week: number): TruthSerumEntry | null {
  return truthSerumTeachings.find(teaching => teaching.week === week) || null;
}

// Get a random teaching from unlocked teachings only
export function getRandomUnlockedTruthSerum(subscriptionStartDate: Date): TruthSerumEntry {
  const unlockedTeachings = getUnlockedTeachings(subscriptionStartDate);
  if (unlockedTeachings.length === 0) {
    // Return first teaching if nothing is unlocked yet
    return truthSerumTeachings[0];
  }
  return unlockedTeachings[Math.floor(Math.random() * unlockedTeachings.length)];
}

// Get preview of next week's teaching (title only)
export function getNextWeekPreview(subscriptionStartDate: Date): string | null {
  const userWeek = getUserWeekProgression(subscriptionStartDate);
  const nextWeekTeaching = getTruthSerumForWeek(userWeek + 1);
  return nextWeekTeaching ? `Coming next week: "${nextWeekTeaching.title}"` : null;
}

// Get total progress information
export function getProgressInfo(subscriptionStartDate: Date): {
  unlockedCount: number;
  totalCount: number;
  currentWeek: number;
  nextUnlockDate: Date | null;
} {
  const userWeek = getUserWeekProgression(subscriptionStartDate);
  const unlockedCount = Math.min(userWeek, truthSerumTeachings.length);
  const totalCount = truthSerumTeachings.length;
  
  // Calculate next unlock date (7 days from current week start)
  let nextUnlockDate: Date | null = null;
  if (unlockedCount < totalCount) {
    nextUnlockDate = new Date(subscriptionStartDate);
    nextUnlockDate.setDate(nextUnlockDate.getDate() + (userWeek * 7));
  }
  
  return {
    unlockedCount,
    totalCount,
    currentWeek: userWeek,
    nextUnlockDate
  };
}